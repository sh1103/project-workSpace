<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.workspace.mapper.ChatMessageMapper">
    <!--    채팅 저장 -->
    <insert id="insertChatMessage">
       INSERT INTO chat_message
        (message, chat_time, user_num, room_name, chat_file)
        VALUES(#{message}, #{chat_time}, #{user_num}, #{room_name}, #{chat_file});
    </insert>

    <!-- 로그인 후 채팅방 목록 가져오기-->
    <select id="getMyChatList" resultType="chatMessageVO">
        select room_name  from chat_message
        where sender_id = #{senderId} or receiver_id = #{receiverId}
        group by room_name
    </select>

    <!--    채팅 가져오기-->
    <select id="getChatList" resultType="chatMessageVO">
        select message_num, message, chat_time, sender_id, receiver_id  from chat_message
        where  sender_id =#{sender_id} or receiver_id =#{receiver_id}
        order by message_num asc
    </select>

<!--    너와 나의 채팅 이력 유무 확인-->
    <select id="getChatHistory" resultType="_int">
        select count(room_name) from chat_message
        where sender_id = #{senderId} and receiver_id = #{receiverId}
        group by room_name;
    </select>


    <!--    <resultMap type="chatMessageVO" id="result">-->
    <!--        <result property="roomName" column="room_name"/>-->
    <!--        <result property="userId" column="user_id"/>-->
    <!--    </resultMap>-->


</mapper>